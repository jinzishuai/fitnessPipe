appId: com.fitnesspipe.fitnessPipe
---
- launchApp

# ── Portrait mode tests ──────────────────────────────────────────────
# Ensure we start in portrait so the iOS accessibility tree has correct
# coordinates.  Landscape coordinate mapping is broken in Maestro ≥1.41
# (tracked as mobile-dev-inc/maestro#2701).
- setOrientation: PORTRAIT
- assertVisible: "FitnessPipe"

# Wait for camera initialization to complete and exercise selector to appear
- extendedWaitUntil:
    visible: "Select Exercise"
    timeout: 30000

# Select Lateral Raise from the dropdown
- tapOn: "Select Exercise"
- extendedWaitUntil:
    visible: "Lateral Raise"
    timeout: 5000
- tapOn: "Lateral Raise"
- extendedWaitUntil:
    visible: "Lateral Raise"
    timeout: 5000

# Verify counter is > 0 (regex matches 1-9 followed by any digits)
- assertVisible: "[1-9][0-9]*"
- assertVisible: "reps"

# Exercise Navigation — switch to Single Squat
- tapOn: "Lateral Raise"
# Wait for dropdown menu to fully open before tapping the option
- extendedWaitUntil:
    visible: "Single Squat"
    timeout: 5000
- tapOn: "Single Squat"
- extendedWaitUntil:
    visible: "Single Squat"
    timeout: 5000
# Verify counter is > 0 (regex matches 1-9 followed by any digits)
- assertVisible: "[1-9][0-9]*"
- assertVisible: "reps"
- takeScreenshot: "single-squat-counter"

# Switch back to Lateral Raise
- tapOn: "Single Squat"
- extendedWaitUntil:
    visible: "Lateral Raise"
    timeout: 5000
- tapOn: "Lateral Raise"
- extendedWaitUntil:
    visible: "Lateral Raise"
    timeout: 5000

# Counter Checks
# Verify counter overlay is present and > 0
- assertVisible: "[1-9][0-9]*"
- assertVisible: "reps"
- takeScreenshot: "lateral-raise-counter"

# ── Landscape mode tests ─────────────────────────────────────────────
# Switch to landscape and verify the app renders correctly.
# NOTE: Due to Maestro#2701, elements on the left half of the landscape
# screen have negative accessibility coordinates and are invisible to
# Maestro.  We can only assert elements that remain in the visible
# (right-half) region of the accessibility tree.  Full landscape element
# interaction will be possible once Maestro ships the fix (MAE-275).
- setOrientation: LANDSCAPE_LEFT
- extendedWaitUntil:
    visible: "FitnessPipe"
    timeout: 10000
